[TOC]

### 前言

1. 本项目几乎融合了我个人编程工作生涯中使用过的技术点，目前只写了一部分内容，后续会逐步更新

2. 项目技术栈：Python3.7 + Django + MySQL + Redis + Kafka + Celery 等，项目开发步骤及详情参考目录

3. 欢迎大家参考、指正和完善

### 目录

#### 一. [准备工作]()

1. 登录云服务器
2. 假设系统中的 Python3 版本比较低，想卸载后下载更高版本
3. CentOS7 安装 Python3 版本

#### 二. [虚拟环境]()

1. 下载 virtualenv 和 virtualenvwrapper
2. 新建虚拟环境

#### 三. [新建项目]()

#### 四. [Pycharm 中添加虚拟环境]()

#### 五. [提交代码到远程仓库]()

1. GitHub 注册账号, 登录
2. 新建一个仓库：oms_test
3. 提交新建的项目代码到该远程代码仓库

#### 六. [添加配置文件夹]()

#### 七.  [CentOS7 中安装 MySQL]()

1. 检测系统中是否有 MySQL
2. 安装资源包
3. 启动 MySQL
4. MySQL 客户端
5. MariaDB 的安装（备选）

#### 八. [MySQL 数据库的配置]()

1. 本地登录 MySQL 
2. MySQL 修改密码的方法示例
3. 新建数据库
4. 导入配置文件内容
5. 注释掉配置文件中数据库的配置代码
6. 安装 pymysql
7. 导入 pymysql 包
8. Pycharm 中链接 MySQL
9. 将代码更新到远程仓库

#### 九. [添加忽略文件 .gitignore]()

#### 十. [第一次运行项目]()

#### 十一. [添加钉钉报警机器人功能]()

1. 钉钉群添加群机器人
2. 项目中添加钉钉报警 API 示例

#### 十二. [新增店铺信息]()

1. 新建 store 子应用
2. 新建 Store 模型类
3. 迁移数据库
4. MySQL 数据库新建 oms_store 表
5. 批量创建数据（方法一）
6. 批量创建数据（方法二）
7. 批量创建数据（方法三）
8. 使用 Redis 管理批量创建数据

#### 十三. [Ubuntu 中 Redis 集群的创建]()

1. 安装 Redis 
2. 启动 Redis
3. 配置 Redis 集群
4. 启动 Redis 集群服务
5. 进入集群

#### 十四. [CentOS7 中 Redis 集群的创建]()

1. 安装 Redis
2. 启动 Redis
3. 设置 Redis 以服务命令形式启动
4. 配置 Redis 集群
5. 启动 Redis 集群服务
6. 进入集群
7. Redis 数据类型使用示例

#### 十五. [将各平台店铺账户信息保存进 Redis ]()

1. 项目中安装 Redis 和 RedisCluster
2. 配置文件夹 oms_conf 中新增 oms_redis.py 文件
3. 项目配置文件中导入 Redis 集群配置内容
4. 安装 rest_framework
5. 将店铺账户信息写入到 Redis 集群中
6. 进入 Redis 集群，验证刚才保存的值是否能获取到
7. 新增 Redis 查询接口
8. Postman 的使用

#### 十六. [项目中生成 API 文档]()

1. 安装 apidoc
2. 项目根目录下新建 apidoc.json 文件
3. apidoc 在项目中的配置
4. 添加路径
5. 项目子应用下添加文档文件
6. 执行文档生成命令
7. 验证是否生成文档
8. 忽略文件新增忽略内容

#### 十七. [权限验证]()

1. 新建 user/system 子应用
2. 添加到配置文件中
3. 新建 User 模型类
4. Redis 查询接口添加权限验证

#### 十八. [日志模块 loguru 基本用法]()

1. 安装 loguru
2. 基本用法示例

#### 十九. [Kafka 的基本使用和单机伪集群搭建]()

1. 下载 JDK
2. 安装 JDK
3. 配置 JDK 环境变量
4. 官网下载并解压 kafka
5. 启动 zookeeper 和 kafka
6. 创建一个主题 quickstart-events
7. 查看新主题的分区数
8. 自主创建生产-消费者模型
9. 删除本地 kafka 环境的任何数据
10. 单机伪集群配置

#### 二十. [Pykafka 的使用]()

1. 安装 pykafka
2. Pykafka 基本使用示例

#### 二十一. [项目中日志使用示例]()

1. 配置内容
2. 项目配置文件
3. kafka 日志使用示例
4. 忽略文件添加日志信息

#### 二十二. [aiokafka 与 kafka-python 库的配合使用]()

1. 安装 asyncio 和 aiokafka
2. 简单使用示例
3. 高并发时的使用示例

#### 二十三. [项目中 pykafka 库与 MySQL 使用示例]()

1. pykafka 接口
2. MySQL 数据库连接池（Connection pooling）
3. 安装必要包
4. 新建 MySQL 配置文件
5. MySQL 接口
6. 模拟 Kafka 生产者与消费者

#### 二十四. [MySQL 主从复制（以 CentOS7 为例）]()

1. 下载 MySQL
2. 将文件上传到远程服务器
3. 上传后解压
4. 新建 MySQL 数据导入/导出目录
5. 创建多实例数据目录
6. 给 mysql 用户配置目录权限
7. 编写配置文件
8. 初始化实例
9. 复制多实例脚本到服务管理目录下
10. 添加脚本权限
11. 添加进 service 服务管理
12. mysqld_multi 多实例管理
13. 登录主库实例
14. 关闭主实例的服务 (示例)
15. 查询主库状态
16. 在主库新建同步用户并退出
17. 登录从库实例
18. 查看主从库线程状态
19. 测试主从同步是否生效
20. 设置主从库读写分离（数据库里直接设置权限）
21. 设置从库只能执行读操作

#### 二十五. [MySQL 主从复制（以 Ubuntu 为例）]()

1. 使用 apt 包管理工具安装
2. 停止 MySQL 服务并禁止其自动启动
3. 创建 MySQL 数据存放目录
4. 创建 pid 存放目录
5. 创建日志文件
6. 修改目录权限
7. 复制 MySQL 配置文件
8. 编辑三个实例对应的配置文件
9. 修改 MySQL 配置文件
10. 授权 mysqld 目录访问权限
11. 初始化 3306/3307/3308 这三个实例
12. 修改目录权限
13. 启动运行三个实例并查看
14. 设置三个实例的登录密码
15. 登录实例
16. 设置允许远程链接数据库
17. 解除数据库默认绑定的 IP 地址限制
18. 重启各个实例
19. 设置 3306 端口作为主库
20. 设置 3307/3308 端口作为从库
21. 测试主从复制是否成功
22. 常用语句总结

#### 二十六. [项目中配置 MySQL 主从复制与读写分离]()

1. 数据库主从复制与读写分离配置
2. 项目配置文件添加 MySQL 配置内容
3. PyCharm 中 Database 重新链接
4. 重新迁移项目数据库并添加测试数据
5. 验证主从复制是否成功
6. 虚拟环境安装 ipython
7. 模型类中使用 `__str__` 
8. 项目启动时报错 MySQL 无法链接解决办法

#### 二十七. [uWSGI 的使用]()

1. 安装 uWSGI
2. 新建 uwsgi.ini
3. 配置文件修改
4. 启动 uWSGI，访问
5. 编写 sh 文件

#### 二十八. [邮件发送（编写一个公用类）]()

#### 二十九. [Django-commands 用法]()

1. 子应用下新建两个 Python 包
2. 安装必要的包
3. Django-commands 用法示例
4. 新增店铺日志配置
5. 编写脚本
6. 测试发送邮件是否生效（附件添加 excel 文件）

#### 三十. [登录验证装饰器]()

#### 三十一. [超管验证装饰器]()

1. 从 COOKIES 中获取用户名 
2. 装饰器的实现

#### 三十二. [提供选择用户接口]()

1. 视图处理
2. 路径配置

#### 三十三. [权限配置与权限管理]()

1. 新建子应用 basic
2. 新建公共模型类
3. 查看/操作权限表与记录表的创建
4. oms_table.sql 表维护并在数据库创建新表
5. 添加测试数据示例
6. 新增序列化器
7. 获取权限组合视图
8. 分页视图处理
9. 权限配置视图处理
10. 路径配置
11. 权限验证装饰器

#### 三十四. [日志中间件的设计]()

1. 项目日志统一配置
2. 中间件的实现

#### 三十五. [定时任务]()

1. 日志配置
2. 下载并添加 django-crontab
3. 编写一个测试函数
4. 配置定时任务
5. 执行定时任务

#### 三十六. [获取项目所在服务器的 IP 地址]()

#### 三十七. [Django 中 Celery 的使用]()

1. Celery 基本概念
2. 安装 RabbitMQ 和第三方包
3. 项目根目录新建 tasks.py 文件
4. 启动 Celery Worker 服务器
5. 进入 shell 中调度任务
6. 保存结果
7. 项目中定义 Celery 实例
8. 导入到项目模块中
9. 项目配置文件配置 Celery
10. 使用 Django 数据库缓存结果
11. 注意一个小细节
12. .delay() 与 .apply_async() 的联系与区别
13. 获取任务的 ID
14. 使用 celery_once 包对 Redis 加锁
15. 每次重启项目后，异步任务也要重新启动

#### 三十八. [excel 文件上传下载 与 Celery 配合使用]()

1. 项目中新建 excel 上传下载目录
2. 配置文件添加路径
3. 新增日志
4. 新建子应用并注册
5. 视图处理
6. tasks.py 处理 excel 文件内容
7. 分配路由
8. Postman 测试
9. excel 文件导出数据公用配置
10. 获取模型类中字段名与 verbose_name 的对应关系
11. 导出数据示例









